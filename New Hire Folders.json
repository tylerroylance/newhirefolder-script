{"files":[{"id":"efdeec69-a9fc-4800-94bd-965a470aeb98","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Denver\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"924e2d66-e260-4fd2-8baf-97440804fad7","name":"Code","type":"server_js","source":"function doPost(e) {\n  try {\n    // Parse the POST body\n    var data \u003d JSON.parse(e.postData.contents);\n\n    // Get first name and last name from the POST body\n    var firstName \u003d data.firstName;\n    var lastName \u003d data.lastName;\n\n    // Optional: specify a parent folder by ID (passed in from Power Automate)\n    var parentId \u003d data.parentId || null;\n\n    // Set the folder name as \"First Last\"\n    var folderName \u003d firstName + \" \" + lastName;\n\n    // If parentId is provided, use it; otherwise, create in the root folder\n    var parentFolder \u003d parentId\n      ? DriveApp.getFolderById(parentId)\n      : DriveApp.getRootFolder();\n\n    // Create the main folder inside the parent folder\n    var mainFolder \u003d parentFolder.createFolder(folderName);\n\n    // Define subfolder names\n    var subfolders \u003d [\"Onboarding\", \"Performance Review\", \"Status Change\", \"Warnings\"];\n\n    // Create each subfolder inside the main folder\n    subfolders.forEach(function(name) {\n      mainFolder.createFolder(name);\n    });\n\n    // Return a success response with the folder ID and URL\n    return ContentService.createTextOutput(\n      JSON.stringify({\n        status: \"success\",\n        folderId: mainFolder.getId(),\n        folderUrl: mainFolder.getUrl()\n      })\n    ).setMimeType(ContentService.MimeType.JSON);\n\n  } catch (err) {\n    // Return an error response\n    return ContentService.createTextOutput(\n      JSON.stringify({ status: \"error\", message: err.message })\n    ).setMimeType(ContentService.MimeType.JSON);\n  }\n}\n\n"}]}